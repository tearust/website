<html>
<head>
  <link rel="icon" type="image/x-icon" href="/tea-logo/favicon32.ico">
  <script src="https://code.jquery.com/jquery-2.0.0.min.js"></script>
  <link rel="preload" href="//at.alicdn.com/t/font_2651648_4qbjfdk1ka.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="//at.alicdn.com/t/font_2651648_k9tsl3u8ko.css">

  <link rel="stylesheet" href="/docs/mdlibs/index.css?v=1627757468628">
</head>
<body>

<div class="t-md"><h1 id="tea-vs-trusted-computing">TEA vs Trusted Computing</h1>
<p>The <strong>TEA</strong> in TEA Project stands for <strong>T</strong>rusted <strong>E</strong>xecution and <strong>Attestation</strong>. The TEA Project places great emphasis on <strong>Trust</strong>, as running a dApp on the platform means trusting a remote node where you don&#39;t know where in the world it&#39;s located, who owns it, what&#39;s loaded in its memory and if the hardware/software config is actually what the owner claims.</p>
<p>The ultimate solution involves using cryptography so that you don&#39;t need to worry about any of these security concerns. There are some existing software solution, such as <a target='_blank'  href="https://en.wikipedia.org/wiki/Homomorphic_encryption">FHE</a> and <a target='_blank'  href="https://en.wikipedia.org/wiki/Secure_multi-party_computation">SMPC</a>. However, they come with a huge computational cost. To be practical, we&#39;ll focus on hardware solutions only.</p>
<p>A hardware solution means that the code and data actually run on a remote TEA node that&#39;s protected by hardware. The hardware can provide PoT (Proof of Trust) for remote attestation as well as a hardware-protected &quot;enclave&quot; where code and data can run. The former is typically called TPM (Trusted Platform Module) / HSM (Hardware Security Module); the latter is generally called TEE (Trusted Execution Environment).</p>
<h2 id="tpm-and-hsm">TPM and HSM</h2>
<p>All these questions need to be done by a remote attestation process. However remote attestation needs <strong>evidence (PoT)</strong> to verify against a <strong>claim</strong>. The claims can be easily queried from the blockchain. But how about evidence? How do you know the proof coming from another node is the truth?</p>
<p><img src="http://64.227.49.206:3001/res/tea-node-arch.png" />
This is one of the problems that trusted computing needs to solve. Another problem is <a target='_blank'  href="https://en.wikipedia.org/wiki/Data_in_use#Enclaves">Data in use</a>, which can be solved by a TEE enclave.</p>
<p>The TEA nodes are logically split into two areas. The secure area in red and the non-secure area in green. The non-secure area is not protected, so any sensitive data needs to be encrypted if it ever resides in this area. The secure area is protected so that it&#39;s safe for data to be decrypted while it&#39;s inside this area. The computation happens inside the secure area as plain, unencrypted data so that it runs in native speed as no FHE or SMPC is needed. </p>
<p>In the TEA project, we use a typical TCG 2.0 technical stack such as Measured Boot. 
<img src="http://64.227.49.206:3001/res/measured-boot.png" /></p>
<p>TCG 2.0 is a complicated system, and going into detail here would be outside the bounds of this article. You can easily get more information by reading TCG 2.0 standard <a target='_blank'  href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">documents</a>. Another good learning resource is <a target='_blank'  href="https://google.github.io/tpm-js/">Google&#39;s TPM-js project</a>. </p>
<p>The PCR stack values are published to the blockchain during the booting process along with its claim. This is so that any other TEA nodes can get this node&#39;s PCR stack by regenerating the PCR stack from the claim. This allows any TEA node to verify if any particular TEA node&#39;s claim matches the truth. This is one essential feature TEA uses for remote attestation. Besides this feature, we also use VRF to select multiple remote attestation nodes as a <a target='_blank'  href="https://en.wikipedia.org/wiki/Byzantine_fault">BFT</a> committee to make the group decision. </p>
<h2 id="tee">TEE</h2>
<p>TEE is a very different approach. It makes the protected area even smaller, into a small part of the RAM and inside the CPU chip. We can use Intel SGX as an example.</p>
<p><img src="https://software.intel.com/content/dam/develop/public/us/en/images/diagrams-infographics/diagram-sgx-approach-16x9.png.rendition.intel.web.480.270.png" alt="SGX"></p>
<p>All sensitive data is decrypted and processed inside the small area called <strong>enclave</strong>. Even the OS has no access to it because the encryption key is inside the CPU hardware. In this case, the trust and protection come from the CPU manufacturer. In most cases, we have to trust the CPU although there are always a few exploitable vulnerabilities to be found. </p>
<p>Given the trust comes from the CPU manufacturer, the remote attestation is easier since it&#39;s centralizedâ€”the difficulties are transferred to the dApp developers. Due to limited resources inside the enclave, the developers need to figure out which function to run inside of the enclave to gain security and which functions to run outside of enclave to gain performance. Security and performance are always a trade-off.  </p>
<h2 id="when-to-use-tpm-and-when-to-use-tee">When to Use TPM, and When to Use TEE?</h2>
<p>The TEA Project supports both TPM/HSM and TEE solutions as the source of trust. Which solution a TEA node to choose depends on the specific use case.</p>
<p>Not all CPUs have a TEE feature. Some special-purpose computers usevspecial chips that may not be a general-purpose CPU. For example, AI requires GPU or TPU rather than a CPU. Smaller low power IoT device may use low-power CPUs that do not support TEE. in those exceptional cases, TPM/HSM is the best solution.</p>
<p>On the other hand, a general-purpose computer is usually equipped with x86 / ARM CPU which either supports Intel SGX / AMD-TEE or ARM Trustzone. Most of these machines also have a built-in TPM. So some combination of TEE / TPM can be used in this case. </p>
<p>No matter which solution the TEA nodes chooses, the majority of the workflow is the same. The only differences are the remote attestation workflow and how the WASM code is loaded into the CPU. </p>
<p>When a client submits a computation task, he can claim the requirement in the  JSON description file. For example, if this task is an AI task, a TPU is required. The Capability-checker will ensure only capable TEA nodes &quot;host&quot; this dApp and execute the code.</p>
</div>
  
</body>
</html>